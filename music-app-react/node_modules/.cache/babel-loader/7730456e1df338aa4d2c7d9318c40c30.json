{"ast":null,"code":"var AbstractLevelDOWN = require('abstract-leveldown').AbstractLevelDOWN;\n\nvar inherits = require('inherits');\n\nvar DeferredIterator = require('./deferred-iterator');\n\nvar deferrables = 'put get del batch'.split(' ');\n\nfunction DeferredLevelDOWN(db) {\n  AbstractLevelDOWN.call(this, '');\n  this._db = db;\n  this._operations = [];\n  this._iterators = [];\n  closed(this);\n}\n\ninherits(DeferredLevelDOWN, AbstractLevelDOWN);\n\nDeferredLevelDOWN.prototype._open = function (options, callback) {\n  var self = this;\n\n  this._db.open(options, function (err) {\n    if (err) return callback(err);\n\n    self._operations.forEach(function (op) {\n      self._db[op.method].apply(self._db, op.args);\n    });\n\n    self._operations = [];\n\n    self._iterators.forEach(function (it) {\n      it.setDb(self._db);\n    });\n\n    self._iterators = [];\n    open(self);\n    callback();\n  });\n};\n\nDeferredLevelDOWN.prototype._close = function (callback) {\n  var self = this;\n\n  this._db.close(function (err) {\n    if (err) return callback(err);\n    closed(self);\n    callback();\n  });\n};\n\nfunction open(self) {\n  deferrables.concat('iterator').forEach(function (m) {\n    self['_' + m] = function () {\n      return this._db[m].apply(this._db, arguments);\n    };\n  });\n\n  if (self._db.approximateSize) {\n    self.approximateSize = function () {\n      return this._db.approximateSize.apply(this._db, arguments);\n    };\n  }\n}\n\nfunction closed(self) {\n  deferrables.forEach(function (m) {\n    self['_' + m] = function () {\n      this._operations.push({\n        method: m,\n        args: arguments\n      });\n    };\n  });\n\n  if (typeof self._db.approximateSize === 'function') {\n    self.approximateSize = function () {\n      this._operations.push({\n        method: 'approximateSize',\n        args: arguments\n      });\n    };\n  }\n\n  self._iterator = function (options) {\n    var it = new DeferredIterator(options);\n\n    this._iterators.push(it);\n\n    return it;\n  };\n}\n\nDeferredLevelDOWN.prototype._serializeKey = function (key) {\n  return key;\n};\n\nDeferredLevelDOWN.prototype._serializeValue = function (value) {\n  return value;\n};\n\nmodule.exports = DeferredLevelDOWN;\nmodule.exports.DeferredIterator = DeferredIterator;","map":{"version":3,"sources":["/home/user/orbit-playground/music-app/node_modules/levelup/node_modules/deferred-leveldown/deferred-leveldown.js"],"names":["AbstractLevelDOWN","require","inherits","DeferredIterator","deferrables","split","DeferredLevelDOWN","db","call","_db","_operations","_iterators","closed","prototype","_open","options","callback","self","open","err","forEach","op","method","apply","args","it","setDb","_close","close","concat","m","arguments","approximateSize","push","_iterator","_serializeKey","key","_serializeValue","value","module","exports"],"mappings":"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","sourcesContent":["var AbstractLevelDOWN = require('abstract-leveldown').AbstractLevelDOWN\nvar inherits = require('inherits')\nvar DeferredIterator = require('./deferred-iterator')\nvar deferrables = 'put get del batch'.split(' ')\n\nfunction DeferredLevelDOWN (db) {\n  AbstractLevelDOWN.call(this, '')\n  this._db = db\n  this._operations = []\n  this._iterators = []\n  closed(this)\n}\n\ninherits(DeferredLevelDOWN, AbstractLevelDOWN)\n\nDeferredLevelDOWN.prototype._open = function (options, callback) {\n  var self = this\n\n  this._db.open(options, function (err) {\n    if (err) return callback(err)\n\n    self._operations.forEach(function (op) {\n      self._db[op.method].apply(self._db, op.args)\n    })\n    self._operations = []\n    self._iterators.forEach(function (it) {\n      it.setDb(self._db)\n    })\n    self._iterators = []\n    open(self)\n    callback()\n  })\n}\n\nDeferredLevelDOWN.prototype._close = function (callback) {\n  var self = this\n\n  this._db.close(function (err) {\n    if (err) return callback(err)\n    closed(self)\n    callback()\n  })\n}\n\nfunction open (self) {\n  deferrables.concat('iterator').forEach(function (m) {\n    self['_' + m] = function () {\n      return this._db[m].apply(this._db, arguments)\n    }\n  })\n  if (self._db.approximateSize) {\n    self.approximateSize = function () {\n      return this._db.approximateSize.apply(this._db, arguments)\n    }\n  }\n}\n\nfunction closed (self) {\n  deferrables.forEach(function (m) {\n    self['_' + m] = function () {\n      this._operations.push({ method: m, args: arguments })\n    }\n  })\n  if (typeof self._db.approximateSize === 'function') {\n    self.approximateSize = function () {\n      this._operations.push({\n        method: 'approximateSize',\n        args: arguments\n      })\n    }\n  }\n  self._iterator = function (options) {\n    var it = new DeferredIterator(options)\n    this._iterators.push(it)\n    return it\n  }\n}\n\nDeferredLevelDOWN.prototype._serializeKey = function (key) {\n  return key\n}\n\nDeferredLevelDOWN.prototype._serializeValue = function (value) {\n  return value\n}\n\nmodule.exports = DeferredLevelDOWN\nmodule.exports.DeferredIterator = DeferredIterator\n"]},"metadata":{},"sourceType":"script"}