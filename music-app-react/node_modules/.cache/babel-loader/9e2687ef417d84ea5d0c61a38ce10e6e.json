{"ast":null,"code":"'use strict';\n\nclass FeedIndex {\n  constructor() {\n    this._index = {};\n  }\n\n  get() {\n    return Object.keys(this._index).map(f => this._index[f]);\n  }\n\n  updateIndex(oplog) {\n    this._index = {};\n    oplog.values.reduce((handled, item) => {\n      if (!handled.includes(item.hash)) {\n        handled.push(item.hash);\n\n        if (item.payload.op === 'ADD') {\n          this._index[item.hash] = item;\n        } else if (item.payload.op === 'DEL') {\n          delete this._index[item.payload.value];\n        }\n      }\n\n      return handled;\n    }, []);\n  }\n\n}\n\nmodule.exports = FeedIndex;","map":{"version":3,"sources":["/home/user/orbit-playground/music-app/node_modules/orbit-db-feedstore/src/FeedIndex.js"],"names":["FeedIndex","constructor","_index","get","Object","keys","map","f","updateIndex","oplog","values","reduce","handled","item","includes","hash","push","payload","op","value","module","exports"],"mappings":"AAAA;;AAEA,MAAMA,SAAN,CAAgB;AACdC,EAAAA,WAAW,GAAG;AACZ,SAAKC,MAAL,GAAc,EAAd;AACD;;AAEDC,EAAAA,GAAG,GAAG;AACJ,WAAOC,MAAM,CAACC,IAAP,CAAY,KAAKH,MAAjB,EAAyBI,GAAzB,CAA8BC,CAAD,IAAO,KAAKL,MAAL,CAAYK,CAAZ,CAApC,CAAP;AACD;;AAEDC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,SAAKP,MAAL,GAAc,EAAd;AACAO,IAAAA,KAAK,CAACC,MAAN,CAAaC,MAAb,CAAoB,CAACC,OAAD,EAAUC,IAAV,KAAmB;AACrC,UAAG,CAACD,OAAO,CAACE,QAAR,CAAiBD,IAAI,CAACE,IAAtB,CAAJ,EAAiC;AAC/BH,QAAAA,OAAO,CAACI,IAAR,CAAaH,IAAI,CAACE,IAAlB;;AACA,YAAGF,IAAI,CAACI,OAAL,CAAaC,EAAb,KAAoB,KAAvB,EAA8B;AAC5B,eAAKhB,MAAL,CAAYW,IAAI,CAACE,IAAjB,IAAyBF,IAAzB;AACD,SAFD,MAEO,IAAGA,IAAI,CAACI,OAAL,CAAaC,EAAb,KAAoB,KAAvB,EAA8B;AACnC,iBAAO,KAAKhB,MAAL,CAAYW,IAAI,CAACI,OAAL,CAAaE,KAAzB,CAAP;AACD;AACF;;AACD,aAAOP,OAAP;AACD,KAVD,EAUG,EAVH;AAWD;;AAtBa;;AAyBhBQ,MAAM,CAACC,OAAP,GAAiBrB,SAAjB","sourcesContent":["'use strict'\n\nclass FeedIndex {\n  constructor() {\n    this._index = {}\n  }\n\n  get() {\n    return Object.keys(this._index).map((f) => this._index[f])\n  }\n\n  updateIndex(oplog) {\n    this._index = {}\n    oplog.values.reduce((handled, item) => {\n      if(!handled.includes(item.hash)) {\n        handled.push(item.hash)\n        if(item.payload.op === 'ADD') {\n          this._index[item.hash] = item\n        } else if(item.payload.op === 'DEL') {\n          delete this._index[item.payload.value]\n        }\n      }\n      return handled\n    }, [])\n  }\n}\n\nmodule.exports = FeedIndex\n"]},"metadata":{},"sourceType":"script"}