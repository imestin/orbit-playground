{"ast":null,"code":"'use strict';\n\nrequire('node-forge/lib/asn1');\n\nrequire('node-forge/lib/rsa');\n\nconst forge = require('node-forge/lib/forge');\n\nconst {\n  bigIntegerToUintBase64url,\n  base64urlToBigInteger\n} = require('./../util');\n\nconst uint8ArrayFromString = require('uint8arrays/from-string');\n\nconst uint8ArrayToString = require('uint8arrays/to-string'); // Convert a PKCS#1 in ASN1 DER format to a JWK key\n\n\nexports.pkcs1ToJwk = function (bytes) {\n  const asn1 = forge.asn1.fromDer(uint8ArrayToString(bytes, 'ascii'));\n  const privateKey = forge.pki.privateKeyFromAsn1(asn1); // https://tools.ietf.org/html/rfc7518#section-6.3.1\n\n  return {\n    kty: 'RSA',\n    n: bigIntegerToUintBase64url(privateKey.n),\n    e: bigIntegerToUintBase64url(privateKey.e),\n    d: bigIntegerToUintBase64url(privateKey.d),\n    p: bigIntegerToUintBase64url(privateKey.p),\n    q: bigIntegerToUintBase64url(privateKey.q),\n    dp: bigIntegerToUintBase64url(privateKey.dP),\n    dq: bigIntegerToUintBase64url(privateKey.dQ),\n    qi: bigIntegerToUintBase64url(privateKey.qInv),\n    alg: 'RS256',\n    kid: '2011-04-29'\n  };\n}; // Convert a JWK key into PKCS#1 in ASN1 DER format\n\n\nexports.jwkToPkcs1 = function (jwk) {\n  const asn1 = forge.pki.privateKeyToAsn1({\n    n: base64urlToBigInteger(jwk.n),\n    e: base64urlToBigInteger(jwk.e),\n    d: base64urlToBigInteger(jwk.d),\n    p: base64urlToBigInteger(jwk.p),\n    q: base64urlToBigInteger(jwk.q),\n    dP: base64urlToBigInteger(jwk.dp),\n    dQ: base64urlToBigInteger(jwk.dq),\n    qInv: base64urlToBigInteger(jwk.qi)\n  });\n  return uint8ArrayFromString(forge.asn1.toDer(asn1).getBytes(), 'ascii');\n}; // Convert a PKCIX in ASN1 DER format to a JWK key\n\n\nexports.pkixToJwk = function (bytes) {\n  const asn1 = forge.asn1.fromDer(uint8ArrayToString(bytes, 'ascii'));\n  const publicKey = forge.pki.publicKeyFromAsn1(asn1);\n  return {\n    kty: 'RSA',\n    n: bigIntegerToUintBase64url(publicKey.n),\n    e: bigIntegerToUintBase64url(publicKey.e),\n    alg: 'RS256',\n    kid: '2011-04-29'\n  };\n}; // Convert a JWK key to PKCIX in ASN1 DER format\n\n\nexports.jwkToPkix = function (jwk) {\n  const asn1 = forge.pki.publicKeyToAsn1({\n    n: base64urlToBigInteger(jwk.n),\n    e: base64urlToBigInteger(jwk.e)\n  });\n  return uint8ArrayFromString(forge.asn1.toDer(asn1).getBytes(), 'ascii');\n};","map":{"version":3,"sources":["/home/user/orbit-playground/music-app/node_modules/libp2p-kad-dht/node_modules/libp2p-crypto/src/keys/rsa-utils.js"],"names":["require","forge","bigIntegerToUintBase64url","base64urlToBigInteger","uint8ArrayFromString","uint8ArrayToString","exports","pkcs1ToJwk","bytes","asn1","fromDer","privateKey","pki","privateKeyFromAsn1","kty","n","e","d","p","q","dp","dP","dq","dQ","qi","qInv","alg","kid","jwkToPkcs1","jwk","privateKeyToAsn1","toDer","getBytes","pkixToJwk","publicKey","publicKeyFromAsn1","jwkToPkix","publicKeyToAsn1"],"mappings":"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","sourcesContent":["'use strict'\n\nrequire('node-forge/lib/asn1')\nrequire('node-forge/lib/rsa')\nconst forge = require('node-forge/lib/forge')\nconst { bigIntegerToUintBase64url, base64urlToBigInteger } = require('./../util')\nconst uint8ArrayFromString = require('uint8arrays/from-string')\nconst uint8ArrayToString = require('uint8arrays/to-string')\n\n// Convert a PKCS#1 in ASN1 DER format to a JWK key\nexports.pkcs1ToJwk = function (bytes) {\n  const asn1 = forge.asn1.fromDer(uint8ArrayToString(bytes, 'ascii'))\n  const privateKey = forge.pki.privateKeyFromAsn1(asn1)\n\n  // https://tools.ietf.org/html/rfc7518#section-6.3.1\n  return {\n    kty: 'RSA',\n    n: bigIntegerToUintBase64url(privateKey.n),\n    e: bigIntegerToUintBase64url(privateKey.e),\n    d: bigIntegerToUintBase64url(privateKey.d),\n    p: bigIntegerToUintBase64url(privateKey.p),\n    q: bigIntegerToUintBase64url(privateKey.q),\n    dp: bigIntegerToUintBase64url(privateKey.dP),\n    dq: bigIntegerToUintBase64url(privateKey.dQ),\n    qi: bigIntegerToUintBase64url(privateKey.qInv),\n    alg: 'RS256',\n    kid: '2011-04-29'\n  }\n}\n\n// Convert a JWK key into PKCS#1 in ASN1 DER format\nexports.jwkToPkcs1 = function (jwk) {\n  const asn1 = forge.pki.privateKeyToAsn1({\n    n: base64urlToBigInteger(jwk.n),\n    e: base64urlToBigInteger(jwk.e),\n    d: base64urlToBigInteger(jwk.d),\n    p: base64urlToBigInteger(jwk.p),\n    q: base64urlToBigInteger(jwk.q),\n    dP: base64urlToBigInteger(jwk.dp),\n    dQ: base64urlToBigInteger(jwk.dq),\n    qInv: base64urlToBigInteger(jwk.qi)\n  })\n\n  return uint8ArrayFromString(forge.asn1.toDer(asn1).getBytes(), 'ascii')\n}\n\n// Convert a PKCIX in ASN1 DER format to a JWK key\nexports.pkixToJwk = function (bytes) {\n  const asn1 = forge.asn1.fromDer(uint8ArrayToString(bytes, 'ascii'))\n  const publicKey = forge.pki.publicKeyFromAsn1(asn1)\n\n  return {\n    kty: 'RSA',\n    n: bigIntegerToUintBase64url(publicKey.n),\n    e: bigIntegerToUintBase64url(publicKey.e),\n    alg: 'RS256',\n    kid: '2011-04-29'\n  }\n}\n\n// Convert a JWK key to PKCIX in ASN1 DER format\nexports.jwkToPkix = function (jwk) {\n  const asn1 = forge.pki.publicKeyToAsn1({\n    n: base64urlToBigInteger(jwk.n),\n    e: base64urlToBigInteger(jwk.e)\n  })\n\n  return uint8ArrayFromString(forge.asn1.toDer(asn1).getBytes(), 'ascii')\n}\n"]},"metadata":{},"sourceType":"script"}