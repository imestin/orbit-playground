{"ast":null,"code":"'use strict';\n\nconst fs = require('fs');\n\nconst format = require('util').format;\n\nconst EventEmitter = require('events').EventEmitter;\n\nlet isElectronRenderer = process.type && process.type === 'renderer';\nlet isNodejs = !isElectronRenderer && process.version ? true : false;\nconst LogLevels = {\n  'DEBUG': 'DEBUG',\n  'INFO': 'INFO',\n  'WARN': 'WARN',\n  'ERROR': 'ERROR',\n  'NONE': 'NONE'\n}; // Global log level\n\nlet GlobalLogLevel = LogLevels.DEBUG; // Global log file name\n\nlet GlobalLogfile = null;\nlet GlobalEvents = new EventEmitter(); // ANSI colors\n\nlet Colors = {\n  'Black': 0,\n  'Red': 1,\n  'Green': 2,\n  'Yellow': 3,\n  'Blue': 4,\n  'Magenta': 5,\n  'Cyan': 6,\n  'Grey': 7,\n  'White': 9,\n  'Default': 9\n}; // CSS colors\n\nif (!isNodejs) {\n  Colors = {\n    'Black': 'Black',\n    'Red': 'IndianRed',\n    'Green': 'LimeGreen',\n    'Yellow': 'Orange',\n    'Blue': 'RoyalBlue',\n    'Magenta': 'Orchid',\n    'Cyan': 'SkyBlue',\n    'Grey': 'DimGrey',\n    'White': 'White',\n    'Default': 'Black'\n  };\n}\n\nconst loglevelColors = [Colors.Cyan, Colors.Green, Colors.Yellow, Colors.Red, Colors.Default];\nconst defaultOptions = {\n  useColors: true,\n  color: Colors.Default,\n  showTimestamp: true,\n  useLocalTime: false,\n  showLevel: true,\n  filename: GlobalLogfile,\n  appendFile: true\n};\n\nclass Logger {\n  constructor(category, options) {\n    this.category = category;\n    let opts = {};\n    Object.assign(opts, defaultOptions);\n    Object.assign(opts, options);\n    this.options = opts;\n    this.debug = this.debug.bind(this);\n    this.log = this.log.bind(this);\n    this.info = this.info.bind(this);\n    this.warn = this.warn.bind(this);\n    this.error = this.error.bind(this);\n  }\n\n  debug() {\n    if (this._shouldLog(LogLevels.DEBUG)) this._write(LogLevels.DEBUG, format.apply(null, arguments));\n  }\n\n  log() {\n    if (this._shouldLog(LogLevels.DEBUG)) this.debug.apply(this, arguments);\n  }\n\n  info() {\n    if (this._shouldLog(LogLevels.INFO)) this._write(LogLevels.INFO, format.apply(null, arguments));\n  }\n\n  warn() {\n    if (this._shouldLog(LogLevels.WARN)) this._write(LogLevels.WARN, format.apply(null, arguments));\n  }\n\n  error() {\n    if (this._shouldLog(LogLevels.ERROR)) this._write(LogLevels.ERROR, format.apply(null, arguments));\n  }\n\n  _write(level, text) {\n    if ((this.options.filename || GlobalLogfile) && !this.fileWriter && isNodejs) this.fileWriter = fs.openSync(this.options.filename || GlobalLogfile, this.options.appendFile ? 'a+' : 'w+');\n\n    let format = this._format(level, text);\n\n    let unformattedText = this._createLogMessage(level, text);\n\n    let formattedText = this._createLogMessage(level, text, format.timestamp, format.level, format.category, format.text);\n\n    if (this.fileWriter && isNodejs) fs.writeSync(this.fileWriter, unformattedText + '\\n', null, 'utf-8');\n\n    if (isNodejs || !this.options.useColors) {\n      console.log(formattedText);\n      GlobalEvents.emit('data', this.category, level, text);\n    } else {\n      // TODO: clean this up\n      if (level === LogLevels.ERROR) {\n        if (this.options.showTimestamp && this.options.showLevel) {\n          console.error(formattedText, format.timestamp, format.level, format.category, format.text);\n        } else if (this.options.showTimestamp && !this.options.showLevel) {\n          console.error(formattedText, format.timestamp, format.category, format.text);\n        } else if (!this.options.showTimestamp && this.options.showLevel) {\n          console.error(formattedText, format.level, format.category, format.text);\n        } else {\n          console.error(formattedText, format.category, format.text);\n        }\n      } else {\n        if (this.options.showTimestamp && this.options.showLevel) {\n          console.log(formattedText, format.timestamp, format.level, format.category, format.text);\n        } else if (this.options.showTimestamp && !this.options.showLevel) {\n          console.log(formattedText, format.timestamp, format.category, format.text);\n        } else if (!this.options.showTimestamp && this.options.showLevel) {\n          console.log(formattedText, format.level, format.category, format.text);\n        } else {\n          console.log(formattedText, format.category, format.text);\n        }\n      }\n    }\n  }\n\n  _format(level, text) {\n    let timestampFormat = '';\n    let levelFormat = '';\n    let categoryFormat = '';\n    let textFormat = ': ';\n\n    if (this.options.useColors) {\n      const levelColor = Object.keys(LogLevels).map(f => LogLevels[f]).indexOf(level);\n      const categoryColor = this.options.color;\n\n      if (isNodejs) {\n        if (this.options.showTimestamp) timestampFormat = '\\u001b[3' + Colors.Grey + 'm';\n        if (this.options.showLevel) levelFormat = '\\u001b[3' + loglevelColors[levelColor] + ';22m';\n        categoryFormat = '\\u001b[3' + categoryColor + ';1m';\n        textFormat = '\\u001b[0m: ';\n      } else {\n        if (this.options.showTimestamp) timestampFormat = 'color:' + Colors.Grey;\n        if (this.options.showLevel) levelFormat = 'color:' + loglevelColors[levelColor];\n        categoryFormat = 'color:' + categoryColor + '; font-weight: bold';\n      }\n    }\n\n    return {\n      timestamp: timestampFormat,\n      level: levelFormat,\n      category: categoryFormat,\n      text: textFormat\n    };\n  }\n\n  _createLogMessage(level, text, timestampFormat, levelFormat, categoryFormat, textFormat) {\n    timestampFormat = timestampFormat || '';\n    levelFormat = levelFormat || '';\n    categoryFormat = categoryFormat || '';\n    textFormat = textFormat || ': ';\n\n    if (!isNodejs && this.options.useColors) {\n      if (this.options.showTimestamp) timestampFormat = '%c';\n      if (this.options.showLevel) levelFormat = '%c';\n      categoryFormat = '%c';\n      textFormat = ': %c';\n    }\n\n    let result = '';\n    if (this.options.showTimestamp && !this.options.useLocalTime) result += '' + new Date().toISOString() + ' ';\n    if (this.options.showTimestamp && this.options.useLocalTime) result += '' + new Date().toLocaleString() + ' ';\n    result = timestampFormat + result;\n    if (this.options.showLevel) result += levelFormat + '[' + level + ']' + (level === LogLevels.INFO || level === LogLevels.WARN ? ' ' : '') + ' ';\n    result += categoryFormat + this.category;\n    result += textFormat + text;\n    return result;\n  }\n\n  _shouldLog(level) {\n    let envLogLevel = typeof process !== \"undefined\" && process.env !== undefined && process.env.LOG !== undefined ? process.env.LOG.toUpperCase() : null;\n    envLogLevel = typeof window !== \"undefined\" && window.LOG ? window.LOG.toUpperCase() : envLogLevel;\n    const logLevel = envLogLevel || GlobalLogLevel;\n    const levels = Object.keys(LogLevels).map(f => LogLevels[f]);\n    const index = levels.indexOf(level);\n    const levelIdx = levels.indexOf(logLevel);\n    return index >= levelIdx;\n  }\n\n}\n\n;\n/* Public API */\n\nmodule.exports = {\n  Colors: Colors,\n  LogLevels: LogLevels,\n  setLogLevel: level => {\n    GlobalLogLevel = level;\n  },\n  setLogfile: filename => {\n    GlobalLogfile = filename;\n  },\n  create: (category, options) => {\n    const logger = new Logger(category, options);\n    return logger;\n  },\n  forceBrowserMode: force => isNodejs = !force,\n  // for testing,\n  events: GlobalEvents\n};","map":{"version":3,"sources":["/home/user/orbit-playground/music-app/node_modules/logplease/src/index.js"],"names":["fs","require","format","EventEmitter","isElectronRenderer","process","type","isNodejs","version","LogLevels","GlobalLogLevel","DEBUG","GlobalLogfile","GlobalEvents","Colors","loglevelColors","Cyan","Green","Yellow","Red","Default","defaultOptions","useColors","color","showTimestamp","useLocalTime","showLevel","filename","appendFile","Logger","constructor","category","options","opts","Object","assign","debug","bind","log","info","warn","error","_shouldLog","_write","apply","arguments","INFO","WARN","ERROR","level","text","fileWriter","openSync","_format","unformattedText","_createLogMessage","formattedText","timestamp","writeSync","console","emit","timestampFormat","levelFormat","categoryFormat","textFormat","levelColor","keys","map","f","indexOf","categoryColor","Grey","result","Date","toISOString","toLocaleString","envLogLevel","env","undefined","LOG","toUpperCase","window","logLevel","levels","index","levelIdx","module","exports","setLogLevel","setLogfile","create","logger","forceBrowserMode","force","events"],"mappings":"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","sourcesContent":["'use strict';\n\nconst fs = require('fs');\nconst format = require('util').format;\nconst EventEmitter = require('events').EventEmitter;\n\nlet isElectronRenderer = process.type && process.type === 'renderer';\nlet isNodejs = !isElectronRenderer && process.version ? true : false;\n\nconst LogLevels = {\n  'DEBUG': 'DEBUG',\n  'INFO':  'INFO',\n  'WARN':  'WARN',\n  'ERROR': 'ERROR',\n  'NONE':  'NONE',\n};\n\n// Global log level\nlet GlobalLogLevel = LogLevels.DEBUG;\n\n// Global log file name\nlet GlobalLogfile = null;\n\nlet GlobalEvents = new EventEmitter();\n\n// ANSI colors\nlet Colors = {\n  'Black':   0,\n  'Red':     1,\n  'Green':   2,\n  'Yellow':  3,\n  'Blue':    4,\n  'Magenta': 5,\n  'Cyan':    6,\n  'Grey':    7,\n  'White':   9,\n  'Default': 9,\n};\n\n// CSS colors\nif(!isNodejs) {\n  Colors = {\n    'Black':   'Black',\n    'Red':     'IndianRed',\n    'Green':   'LimeGreen',\n    'Yellow':  'Orange',\n    'Blue':    'RoyalBlue',\n    'Magenta': 'Orchid',\n    'Cyan':    'SkyBlue',\n    'Grey':    'DimGrey',\n    'White':   'White',\n    'Default': 'Black',\n  };\n}\n\nconst loglevelColors = [Colors.Cyan, Colors.Green, Colors.Yellow, Colors.Red, Colors.Default];\n\nconst defaultOptions = {\n  useColors: true,\n  color: Colors.Default,\n  showTimestamp: true,\n  useLocalTime: false,\n  showLevel: true,\n  filename: GlobalLogfile,\n  appendFile: true,\n};\n\nclass Logger {\n  constructor(category, options) {\n    this.category = category;\n    let opts = {};\n    Object.assign(opts, defaultOptions);\n    Object.assign(opts, options);\n    this.options = opts;\n    this.debug = this.debug.bind(this);\n    this.log = this.log.bind(this);\n    this.info = this.info.bind(this);\n    this.warn = this.warn.bind(this);\n    this.error = this.error.bind(this);\n  }\n\n  debug() {\n    if(this._shouldLog(LogLevels.DEBUG))\n      this._write(LogLevels.DEBUG, format.apply(null, arguments));\n  }\n\n  log() {\n    if(this._shouldLog(LogLevels.DEBUG))\n      this.debug.apply(this, arguments);\n  }\n\n  info() {\n    if(this._shouldLog(LogLevels.INFO))\n      this._write(LogLevels.INFO, format.apply(null, arguments));\n  }\n\n  warn() {\n    if(this._shouldLog(LogLevels.WARN))\n      this._write(LogLevels.WARN, format.apply(null, arguments));\n  }\n\n  error() {\n    if(this._shouldLog(LogLevels.ERROR))\n      this._write(LogLevels.ERROR, format.apply(null, arguments));\n  }\n\n  _write(level, text) {\n    if((this.options.filename || GlobalLogfile) && !this.fileWriter && isNodejs)\n      this.fileWriter = fs.openSync(this.options.filename || GlobalLogfile, this.options.appendFile ? 'a+' : 'w+');\n\n    let format = this._format(level, text);\n    let unformattedText = this._createLogMessage(level, text);\n    let formattedText = this._createLogMessage(level, text, format.timestamp, format.level, format.category, format.text);\n\n    if(this.fileWriter && isNodejs)\n      fs.writeSync(this.fileWriter, unformattedText + '\\n', null, 'utf-8');\n\n    if(isNodejs || !this.options.useColors) {\n      console.log(formattedText)\n      GlobalEvents.emit('data', this.category, level, text)\n    } else {\n      // TODO: clean this up\n      if(level === LogLevels.ERROR) {\n        if(this.options.showTimestamp && this.options.showLevel) {\n          console.error(formattedText, format.timestamp, format.level, format.category, format.text)\n        } else if(this.options.showTimestamp && !this.options.showLevel) {\n          console.error(formattedText, format.timestamp, format.category, format.text)\n        } else if(!this.options.showTimestamp && this.options.showLevel) {\n          console.error(formattedText, format.level, format.category, format.text)\n        } else {\n          console.error(formattedText, format.category, format.text)\n        }\n      } else {\n        if(this.options.showTimestamp && this.options.showLevel) {\n          console.log(formattedText, format.timestamp, format.level, format.category, format.text)\n        } else if(this.options.showTimestamp && !this.options.showLevel) {\n          console.log(formattedText, format.timestamp, format.category, format.text)\n        } else if(!this.options.showTimestamp && this.options.showLevel) {\n          console.log(formattedText, format.level, format.category, format.text)\n        } else {\n          console.log(formattedText, format.category, format.text)\n        }\n      }\n    }\n  }\n\n  _format(level, text) {\n    let timestampFormat = '';\n    let levelFormat     = '';\n    let categoryFormat  = '';\n    let textFormat      = ': ';\n\n    if(this.options.useColors) {\n        const levelColor    = Object.keys(LogLevels).map((f) => LogLevels[f]).indexOf(level);\n        const categoryColor = this.options.color;\n\n      if(isNodejs) {\n        if(this.options.showTimestamp)\n          timestampFormat = '\\u001b[3' + Colors.Grey + 'm';\n\n        if(this.options.showLevel)\n          levelFormat = '\\u001b[3' + loglevelColors[levelColor] + ';22m';\n\n        categoryFormat = '\\u001b[3' + categoryColor + ';1m';\n        textFormat = '\\u001b[0m: ';\n      } else {\n        if(this.options.showTimestamp)\n          timestampFormat = 'color:' + Colors.Grey;\n\n        if(this.options.showLevel)\n          levelFormat = 'color:' + loglevelColors[levelColor];\n\n        categoryFormat = 'color:' + categoryColor + '; font-weight: bold';\n      }\n    }\n\n    return {\n      timestamp: timestampFormat,\n      level: levelFormat,\n      category: categoryFormat,\n      text: textFormat\n    };\n  }\n\n  _createLogMessage(level, text, timestampFormat, levelFormat, categoryFormat, textFormat) {\n    timestampFormat = timestampFormat || '';\n    levelFormat     = levelFormat     || '';\n    categoryFormat  = categoryFormat  || '';\n    textFormat      = textFormat      || ': ';\n\n    if(!isNodejs && this.options.useColors) {\n      if(this.options.showTimestamp)\n        timestampFormat = '%c';\n\n      if(this.options.showLevel)\n        levelFormat = '%c';\n\n      categoryFormat  = '%c';\n      textFormat = ': %c';\n    }\n\n    let result = '';\n\n    if(this.options.showTimestamp && !this.options.useLocalTime)\n      result += '' + new Date().toISOString() + ' ';\n\n    if(this.options.showTimestamp && this.options.useLocalTime)\n      result += '' + new Date().toLocaleString() + ' ';\n\n    result = timestampFormat + result;\n\n    if(this.options.showLevel)\n      result += levelFormat + '[' + level +']' + (level === LogLevels.INFO || level === LogLevels.WARN ? ' ' : '') + ' ';\n\n    result += categoryFormat + this.category;\n    result += textFormat + text;\n    return result;\n  }\n\n  _shouldLog(level) {\n    let envLogLevel = (typeof process !== \"undefined\" && process.env !== undefined && process.env.LOG !== undefined) ? process.env.LOG.toUpperCase() : null;\n    envLogLevel = (typeof window !== \"undefined\" && window.LOG) ? window.LOG.toUpperCase() : envLogLevel;\n\n    const logLevel = envLogLevel || GlobalLogLevel;\n    const levels   = Object.keys(LogLevels).map((f) => LogLevels[f]);\n    const index    = levels.indexOf(level);\n    const levelIdx = levels.indexOf(logLevel);\n    return index >= levelIdx;\n  }\n};\n\n/* Public API */\nmodule.exports = {\n  Colors: Colors,\n  LogLevels: LogLevels,\n  setLogLevel: (level) => {\n    GlobalLogLevel = level;\n  },\n  setLogfile: (filename) => {\n    GlobalLogfile = filename;\n  },\n  create: (category, options) => {\n    const logger = new Logger(category, options);\n    return logger;\n  },\n  forceBrowserMode: (force) => isNodejs = !force, // for testing,\n  events: GlobalEvents,\n};\n"]},"metadata":{},"sourceType":"script"}